{% extends "forum_base.html" %}

{% block title %}{{ thread.name }} - {{ thread.board.name }} - Форум | Data.gov.ua {% endblock %}

{% block primary_content %}
    <div class="forum-post-head">
        <h1 class="page-heading">{{ thread.name }}</h1>
        <div class="thread-meta">
            <div class="thread-section work">
                <a href="{{ thread.board.get_absolute_url() }}">{{ thread.board.name }}</a>
            </div>
            <div class="thread-author">
                <a href="{{ h.url_for(controller='user', action='read', id=thread.author.name) }}">{{ thread.author.name }}</a>
            </div>
            <div class="thread-date">{{ h.render_datetime(thread.created, with_hours=True) }}</div>
        </div>
    </div>
    <h1>{{ thread.name }}</h1>

    <div class="forum-post-body">
        {{ h.render_markdown(thread.content) }}
    </div>

    <div class="forum-comments-container">
        {% for p in thread.forum_posts %}
            <div class="forum-comment media">
                <div class="media-left pull-left forum-avatar">
                    {{ h.gravatar((p.author.email_hash), size=64) }}
                </div>
                <div class="media-body comment-body">
                    <div class="comment-head">
                        <a href="{{ h.url_for(controller='user', action='read', id=p.author.name) }}">
                            {{ p.author.name }}
                        </a> {{ h.time_ago_from_timestamp(p.created) }}</div>

                    <div class="comment-body">
                        {{ h.render_markdown(p.content) }}
                    </div>
                </div>

            </div>
        {% endfor %}
    </div>

    <div class="forum-comment comment-action media">
        {% if c.userobj %}
            <div class="media-left pull-left forum-avatar">
                {{ h.gravatar((c.userobj.email_hash), size=64) }}
            </div>
            <div class="media-body comment-body">
                <form method="post">
                    {{ form.csrf_token }}
                    <div class="form-group">

                        <textarea class="form-control" rows="4"
                                  placeholder="Напишіть вашу відповідь на дискусію..." name="content"></textarea>
                    </div>
                    <div class="comment-footer">
                        <span>* Тут ви можете використовувати Markdown форматування</span>
                        <button type="submit" class="btn btn-primary">Опубліковати</button>
                    </div>

                </form>
            </div>
        {% else %}
            <p>You should be logged in to make posts.</p>
        {% endif %}

    </div>
{% endblock %}


